# 3. this

- 대부분 객체 지향언에서 this는 클래스로 생성한 인스턴스 객체를 의미(클래스에서만 사용할 수 있기 때문에 혼란의 여지가 없거나 적음)
- 하지만 자바스크립트에서 this는 어디에서든 사용할 수 있음
- 상황에 따라 this가 바라보는 대상이 달라짐
- 함수와 객체(메서드)의 구분이 느슨한 자바스크립트에서 this는 실질적으로 이 둘을 구분하는 거의 유일한 기능
- 이번장에서 다룰 내용
  - 상황별로 this가 어떻게 달라지는 지
  - 왜 그렇게 되즌지
  - 예상과 다른 대상을 바라보고 있을 경우 그 원인을 효과적으로 추적하는 방법

## 3-1. 상황에 따라 달라지는 this
- 자바스크립트에서 this는 기본적으로 실행컨텍스트가 생성될 때 결정 됨
  - 실행 컨텍스트는 함수를 호출할 때 생성
  - 즉, this는 함수를 호출할 때 결정된다.
    - 함수를 어떤 방식으로 호출하느냐에 따라 달라짐

- 상황별 this가 어떤 값을 보게 되는지 살펴보자 + 원인

### 3-1-1. 전역 공간에서의 this
- 전역공간에서 this는 전역 객체를 가리킵니다.
- `전역 컨텍스트`를 `생성하는 주체`가 `전역 객체`이기 때문
- `전역 객체` - `런타임 환경에 따라` 다른 이름과 정보를 가지고 있음
  - 브라우저 환경 -> 전역객체 : window
  - Node.js 환경 -> 전역 객체 : global

#### this와 관련은 없지만 전역공간에서 발생하는 특이한 성질
- `전역변수`를 선언하면 자바스크립트 엔진은 이를 `전역 객체의 프로퍼티로` 할당 함(window or global)
  - const는 해당 없음
  - var 를 이용해서 전역변수를 선언한 경우에만 해당
  - 더욱 var를 쓰면 안될 것 같다는 생각이 든다.

```js
// 예제 3-3. 전역변수와 전역객체(1) - 브라우저
var a = 1;
console.log(window.a); // 1
```
- 자바스크립트의 모든 변수는 사실 특정 객체의 프로퍼티로서 동작하기 때문
  - 특정 객체 : LexicalEnvironment(이하 L.E)
- 자바스크립트 는 변수를 수집해서 L.E의 프로퍼티로 저장
  - 이후 변수를 호출하면 L.E를 조회해서 일치하는 프로퍼티가 있을 경우 그 값을 반환
  - 전역 컨텍스트의 경우 L.E는 전역객체를 그대로 참조

```js
// 예제 3-5 전역변수와 전역객체(3)
var a= 1;
delete window.a;
console.log(a, window.a, this.a);

// later
```